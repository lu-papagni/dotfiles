{{- /* ft: sh */ -}}
#!/bin/sh

set -- {{ range .packages.unix.common }}{{ . | quote }} {{ end }}

{{ if not .headless -}}
set -- "$@" {{ range .packages.unix.gui }}{{ . | quote }} {{ end }}
{{ end -}}

echo "Found $# system packages to install."

{{ if eq .chezmoi.os "linux" -}}

{{- $distro := .chezmoi.osRelease.id -}}

{{- if eq $distro "fedora" }}
sudo dnf upgrade -y
sudo dnf copr enable dejan/lazygit -y
sudo dnf install -y "$@"

{{- else if eq $distro "debian" "ubuntu" }}
sudo apt-get update && sudo apt-get upgrade -y
sudo apt-get install -y "$@"

{{- else if eq $distro "arch" }}
sudo pacman -Syu --needed --noconfirm "$@"

{{- else if eq $distro "opensuse-tumbleweed" }}
sudo zypper --non-interactive dist-upgrade
sudo zypper --non-interactive install --force-resolution "$@"
{{ end }}

{{- end }}
